{% extends "base.html" %}

{% block title %}Chat - MiaChat{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-3">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Personas</h5>
            </div>
            <div class="list-group list-group-flush">
                {% for persona in personas %}
                <a href="/chat/{{ persona.id }}" class="list-group-item list-group-item-action {% if selected_persona and selected_persona.id == persona.id %}active{% endif %}">
                    {{ persona.name }}
                </a>
                {% endfor %}
            </div>
        </div>
    </div>
    
    <div class="col-md-9">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    {% if selected_persona %}
                    Chat with {{ selected_persona.name }}
                    {% else %}
                    Select a persona to start chatting
                    {% endif %}
                </h5>
            </div>
            <div class="card-body">
                <div id="chat-messages" class="mb-4" style="height: 400px; overflow-y: auto;">
                    {% for message in messages %}
                    <div class="message {% if message.is_user %}text-end{% endif %} mb-3">
                        <div class="message-content {% if message.is_user %}bg-primary text-white{% else %}bg-light{% endif %} p-3 rounded" style="display: inline-block; max-width: 80%;">
                            {{ message.content }}
                        </div>
                        <small class="text-muted">{{ message.timestamp }}</small>
                    </div>
                    {% endfor %}
                </div>
                
                <form id="chat-form" class="mt-3">
                    <div class="input-group">
                        <input type="text" class="form-control" id="message-input" placeholder="Type your message..." {% if not selected_persona %}disabled{% endif %}>
                        <button class="btn btn-primary" type="submit" {% if not selected_persona %}disabled{% endif %}>Send</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById('chat-form').addEventListener('submit', function(e) {
    e.preventDefault();
    const input = document.getElementById('message-input');
    const message = input.value.trim();
    if (message) {
        // TODO: Implement message sending
        input.value = '';
    }
});
</script>
{% endblock %} 